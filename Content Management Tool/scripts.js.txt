document.addEventListener('DOMContentLoaded', () => {
  const articleForm = document.getElementById('articleForm');
  const articlesDiv = document.getElementById('articles');

  articleForm.addEventListener('submit', async (e) => {
    e.preventDefault();

    const title = document.getElementById('title').value;
    const content = document.getElementById('content').value;

    try {
      const response = await fetch('/api/articles', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ title, content }),
      });

      if (response.ok) {
        articleForm.reset();
        fetchArticles();
      }
    } catch (err) {
      console.error('Error saving article:', err);
    }
  });

  async function fetchArticles() {
    try {
      const response = await fetch('/api/articles');
      const articles = await response.json();

      const articlesHTML = articles.map(
        (article) => `
          <div class="article">
            <h2>${article.title}</h2>
            <p>${article.content}</p>
          </div>
        `
      );

      articlesDiv.innerHTML = articlesHTML.join('');
    } catch (err) {
      console.error('Error fetching articles:', err);
    }
  }

  fetchArticles();
});
